:root{
  --accent:#f8d26a;
  --text:#e5e5e5;
  --muted:#bfbfbf;
  --bg1:#1b1b1b;
  --bg2:#000000;

  --edge:#555;
  --edge-hi:#d7c16a;

  --node:#f2ff5d;
  --node-stroke:#2c2c2c;

  --grid-size:40px;
  --grid-alpha:0.22;
  --grid-speed:36s;
  --grid-shift:48px;

  --drawer-width:420px;
}


* { box-sizing:border-box; margin:0; padding:0; }

html,body { height:100%; }

body{
  background:linear-gradient(to bottom, var(--bg1), var(--bg2));
  color:var(--text);
  font-family:Helvetica,Arial,sans-serif;
  overflow:hidden;
  position:relative;
}

/* Background Grid */
body::before{
  content:"";
  position:fixed; inset:-1px;
  pointer-events:none;
  z-index:0;

  background-image:
          linear-gradient(45deg, rgb(255 255 255 / var(--grid-alpha)) 1px, transparent 1px),
          linear-gradient(-45deg, rgb(255 255 255 / var(--grid-alpha)) 1px, transparent 1px);

  background-size:var(--grid-size) var(--grid-size);
  animation:gridShift var(--grid-speed) linear infinite;
}

@keyframes gridShift{
  from { transform:translate(0,0); }
  to   { transform:translate(var(--grid-shift), var(--grid-shift)); }
}

@media(prefers-reduced-motion: reduce){
  body::before{ animation:none; }
}


/* Vignette */
body::after{
  content:"";
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:1;
  background:radial-gradient(circle at 50% 45%, rgba(0,0,0,0), rgba(0,0,0,0.35));
  opacity:.6;
}


/* App */
.app{
  position:relative;
  z-index:2;
  width:100%;
  height:100%;
}

.stage-wrap{
  position:absolute;
  inset:0;
  right:var(--drawer-width);
  z-index:2;
  overflow:hidden;
}


#sidebar{
  position:fixed;
  top:0;
  right:0;
  height:100vh;
  width:var(--drawer-width);
  background:#151515cc;
  backdrop-filter:blur(6px);
  border-left:1px solid #2a2a2a;
  padding:14px;
  overflow-y:auto;
  z-index:5;
  box-shadow:-8px 0 30px #00000055;
}

#sidebar-resizer{
  position:fixed;
  top:0;
  right:var(--drawer-width);
  width:6px;
  height:100vh;
  cursor:ew-resize;
  z-index:5;
}


/* Focus Mode(Table Only) */
body.focus-mode #sidebar-resizer,
body.focus-mode .help-btn,
body.focus-mode .badge,
body.focus-mode #toggleSidebarBtn,
body.focus-mode #focusBtn,
body.focus-mode #presetBox,
body.focus-mode .hint,
body.focus-mode .controls {
  display: none !important;
}

/* Vector Graphics + Table */
body.focus-mode .stage-wrap {
  display: block !important;
}
body.focus-mode #sidebar {
  width: min(320px, 40vw) !important;
}
body.focus-mode #sidebar > h2 {
  display: block !important;
}
body.focus-mode #sidebar table {
  display: table !important;
}


/* Controls[Buttons; Menus] */
.controls { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px; }

select,button{
  appearance:none;
  border-radius:10px;
  padding:10px 14px;
  cursor:pointer;
  background:transparent;
  color:var(--accent);
  border:1px solid var(--accent);
  font-size:.95rem;
}

button.primary{
  background:var(--accent);
  color:#121212;
  border-color:var(--accent);
  font-weight:600;
}

button:hover{
  transform:scale(1.04);
  box-shadow:0 6px 18px rgba(248,210,106,0.25);
  transition:transform .12s, box-shadow .12s;
}

button:disabled{
  opacity:.5;
  cursor:not-allowed;
}

textarea.preset{
  width:100%;
  min-height:120px;
  resize:vertical;
  border-radius:10px;
  padding:12px 14px;
  background:#0e0e0f;
  color:#eaeaea;
  border:1px solid #3b3b3b;
  font-family: "Helvetica Light", sans-serif;
  margin-top:6px;
}

/* Distances Table */
table{
  width:100%;
  border-collapse:collapse;
  font-size:.95rem;
}

thead th{
  text-align:left;
  padding:10px;
  border-bottom:1px solid #2a2a2a;
  color:#efefef;
  background:#171717cc;
  position:sticky;
  top:0;
}

tbody td{
  padding:10px;
  border-bottom:1px solid #1b1b1b;
  background:#141414cc;
}

tbody tr.settled td{
  background:#1a1a1acc;
}

tbody tr.current td{
  outline:1px solid #4b4b4b;
  background:#141414;
}

/* SVG Canvas */
svg{
  width:100%;
  height:100%;
  display:block;
  background:transparent;
  pointer-events:auto;
}

.edge{
  stroke:var(--edge);
  stroke-width:0.4em;
  opacity:.9;
}

.edge.highlight{
  stroke:var(--edge-hi);
  stroke-width:0.3em;
  opacity:1;
}

.edge.hover{
  filter:drop-shadow(0 0 8px rgba(255,255,200,0.60));
}

.node{
  fill:var(--node);
  stroke:var(--node-stroke);
  stroke-width:2;
}

.node.current{
  stroke:var(--accent);
  stroke-width:3;
  filter:drop-shadow(0 0 6px rgba(248,210,106,0.55));
}

.node.settled{
  fill:#bdbdbd;
}

.node.hover{
  filter:drop-shadow(0 0 8px rgba(255,255,200,0.6));
}

.node-label{
  fill:#efefef;
  font-weight:600;
  font-size:1.5em;
  pointer-events:none;
  transform:translateY(-1.5em);
}


.edge-label{
  fill:#000;
  font-size:1.5em;
  text-shadow:0 1px 2px #fffef3;
  pointer-events:none;
}

.edge-label-bg{
  fill:rgb(255,242,126);
  stroke:rgba(255,255,255,0.15);
  stroke-width:1.2;
  filter:drop-shadow(0 0 4px rgba(0,0,0,0.7));
}

.temp-edge{
  stroke:var(--edge-hi);
  stroke-width:3;
  stroke-dasharray:10 7;
  opacity:.95;
  stroke-linecap:round;
}


.badge{
  position:fixed;
  left:12px;
  bottom:12px;
  z-index:6;
  background:#0e0e0fcc;
  border:1px solid #2a2a2a;
  border-radius:8px;
  padding:6px 10px;
  color:var(--muted);
  font-size:.85rem;
  letter-spacing:.02em;
  box-shadow:0 6px 18px rgba(0,0,0,.35);
}


/* Help[Overlay; Button] */
.help-btn{
  position:fixed;
  right:16px;
  bottom:64px;
  z-index:5;
  background:#333;
  color:#e5e5e5;
  border:1px solid #4a4a4a;
  border-radius:10px;
  padding:10px 14px;
  font-weight:700;
}

.help-overlay{
  position:fixed;
  inset:0;
  z-index:9999;
  display:none;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,.70);
  backdrop-filter:blur(6px);
}

.help-overlay.active{
  display:flex !important;
}

.help-card{
  perspective:1400px;
}

.help-card img{
  max-width:88vw;
  max-height:88vh;
  min-height: 40vh;
  min-width: 40vw;

  object-fit:contain;
  border-radius:12px;
  filter:
          drop-shadow(0 0 18px rgba(248,210,106,0.40))
          drop-shadow(0 0 28px rgba(248,210,106,0.34));
  transform:scale(0.92);
  opacity:0;
  animation:helpPop .30s cubic-bezier(0.16,1,0.3,1) forwards;
}

@keyframes helpPop{
  from { transform:scale(.92); opacity:0; }
  to   { transform:scale(1);   opacity:1; }
}


/* Embed Mode(Hide-UI) */
.embed-mode #sidebar{
  display:none !important;
}

.embed-mode #sidebar-resizer,
.embed-mode .badge,
.embed-mode .help-btn,
.embed-mode #focusBtn,
.embed-mode #toggleSidebarBtn {
  display:none !important;
}

/* Focus Mode(Table Only) -Overrides-> Hide-UI */
.focus-mode #sidebar {
  display: block !important;
}
